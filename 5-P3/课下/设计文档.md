# P3解析

## 写在前面

[BUAA-Wander的说明](https://www.cnblogs.com/BUAA-Wander/p/11790154.html)  
这个学长写得比较全面  
我参考了这篇文章

## 此次测试需要的注意的点

1. 指令需要0扩展还是符号扩展、需不需要左移两位  

2. 控制器需要造表

3. PC和MemAddr的取址，是取2-6位

剩下的都是细节

## CPU设计方案综述

### 总体设计概览

使用Logisim开发一个简单的MIPS单周期CPU，总体概述如下：

1. 此CPU为32位CPU

2. 此CPU为单周期设计

3. 此CPU支持的指令集为：  
{addu, subu, ori, lw, sw, beq, lui, nop}

4. nop机器码为0x00000000

5. addu, subu 不支持溢出

6. 以下说明均从功能的角度出发，因为具体的端口声明可以在我的设计文档中找到

### 关键模块定义

1. IFU (Instruction Fetch Unit)



2. GRF (General Register File)

3. ALU (Arithmetic and Logic Unit)

4. DM (Data Memorary)

5. EXT (Extender)

6. CTL (Controller)

Controller负责“关节”

|信号名|方向|描述|
|:---:|:---:|:---:|
|op[5:0]|I||
|func[5:0]|I||
|ALUop[3:0]|O|ALU|
|AluSrc[3:0]|||



---

ALU-part

来的是哪条指令？——op和func决定，引入中间变量  
ALU要执行什么操作？——由中间变量决定

|指令|op|func|
|:---:|:---:|:---:|
|addu|000000|100001|
|subu|000000|100011|
|ori|001101||
|lw|100011||
|sw|101011||
|beq|000100||
|lui|001111||



Q:

1. why begin with IFU?  
IFU取到指令后，指令指挥整个CPU

2. ALU 做啥
同GRF，不关心我要面对lw还是add，我只要做一个ALU应该关心的
加减乘除，或取合取  
至于进行运算的对象是谁，这是controller应该关心的

所以ALUop有多少位，就决定ALU做多少运算  
加减乘除、或取合取，一个比较好的ALU至少要有3位的ALUop输入

How to debug?

1. modular by modular

2. 线路连接  
我把reset接到GRF的clk端口上了。  
所以要检查线路的连接，tunnel是不是对上了端口

3. datapath检查

4. Controller检查

那些关节，什么时候置一，什么时候为0
比如beq，imm16扩展要sign
